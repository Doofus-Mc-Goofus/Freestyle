I apologize for my dogshit spaghetti code. I didn't expect anyone to actually look at it.